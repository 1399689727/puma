<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:task="http://www.springframework.org/schema/task"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:pigeon="http://code.dianping.com/schema/pigeon"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
    http://www.springframework.org/schema/task   
    http://www.springframework.org/schema/task/spring-task-3.0.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://code.dianping.com/schema/pigeon http://code.dianping.com/schema/pigeon/pigeon-service-2.0.xsd">

	<bean name="placeholder" lazy-init="false"
		class="com.dianping.puma.config.InitializeConfig">
		<property name="propertiesPath" value="applicationContext.properties" />
	</bean>

	<!-- annotation scan -->
	<context:component-scan base-package="com.dianping.puma" />

    <task:annotation-driven />

    <pigeon:annotation package="com.dianping.puma.remote.reporter.helper"/>

	<!--bean id="serverConfig" class="com.dianping.puma.config.Config">
		<property name="port" value="8080" />
	</bean-->

	<!-- <import resource="serverConfig-${puma.server.env}.xml" /> -->

	<bean id="binlogInfoHolder"
		  class="com.dianping.puma.core.storage.holder.impl.DefaultBinlogInfoHolder"
		  init-method="init">
		<property name="baseDir" value="/data/appdatas/puma/binlog/"/>
		<property name="bakDir" value="/data/appdatas/puma/binlog/bak/"/>
		<property name="storageBakDir" value="/data/appdatas/puma/bak/"/>
		<property name="masterStorageBaseDir" value="/data/appdatas/puma/storage/master/"/>
		<property name="slaveStorageBaseDir" value="/data/appdatas/puma/storage/slave/"/>
		<property name="binlogIndexBaseDir" value="/data/appdatas/puma/binlogIndex/"/>
	</bean>

	<bean id="storageMasterBackup"
		  class="com.dianping.puma.core.storage.backup.LocalFileBasedBackup"
		  init-method="init">
		<property name="workingBaseFolder" value="/data/appdatas/puma/storage/master" />
		<property name="backupBaseFolder" value="/data/appdatas/puma/bak/storage/master" />
		<property name="backupDay" value="1" />
	</bean>

	<bean id="storageSlaveBackup"
		  class="com.dianping.puma.core.storage.backup.LocalFileBasedBackup"
		  init-method="init">
		<property name="workingBaseFolder" value="/data/appdatas/puma/storage/slave" />
		<property name="backupBaseFolder" value="/data/appdatas/puma/bak/storage/slave" />
		<property name="backupDay" value="1" />
	</bean>

	<bean id="storageBinlogIndexBackup"
		  class="com.dianping.puma.core.storage.backup.LocalFileBasedBackup"
		  init-method="init">
		<property name="workingBaseFolder" value="/data/appdatas/puma/binlogIndex" />
		<property name="backupBaseFolder" value="/data/appdatas/puma/bak/binlogIndex" />
		<property name="backupDay" value="1" />
	</bean>

	<bean id="rawCodec" class="com.dianping.puma.core.codec.RawEventCodec" />

	<bean id="mongoClient" class="com.dianping.puma.biz.olddao.morphia.helper.MongoClient">
	</bean>

   <bean id="seqGeneratorService"
        class="com.dianping.puma.biz.olddao.morphia.helper.MongoSeqGeneratorServiceImpl">
        <property name="mongoClient">
            <ref bean="mongoClient" />
        </property>
        <property name="dbName" value="puma_admin" />
        <property name="collName" value="seq" />
    </bean>

</beans>


    